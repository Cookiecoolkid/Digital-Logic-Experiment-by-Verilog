## 姓名：陈力峥  
## 学号：221240093

## 实验内容
### 实验一：带标志位的加减运算部件
#### 整体方案设计：
在正常完成 32 位加法器的基础上，增加了减法的功能，dataA进行直接输入，dataB经过与 cin 异或之后再进行输入（在 cin == 1的时候相当于取反）同时再增加标志位 ZF SF OF CF.
#### 顶层模块设计：
1. 全加器
2. 四位先行进位模块
3. 十六先行进位模块
#### 描述与定义：
子模块的定义在讲义中已经表达得很清楚了，这边给出 32 位带标志加法器的输入输出端口定义：
1. 输入端口
   1. 32位数据 x，y 分别作为加法器的两个用于计算的数据
   2. 1位输入 sub，在这里相当于 cin，当 sub = 1时执行减法，sub = 0时执行加法
2. 输出端口
   1. 32位数据 f 输出为加法器的计算结果
   2. 1位 OF 表示是否溢出
   3. 1位 SF 表示结果的符号
   4. 1位 CF 表示进位/借位
   5. 1位 ZF 表示结果是否为0
#### 实验原理图：
![](11.png)
#### 关键的设计语句/源代码
![](12.png)
#### 测试与验证
仿真测试及开发板验证将于实验三ALU32一起验证

### 实验二：桶形移位器
#### 整体方案设计：
运用组合逻辑来实现32位桶型移位器，同时需要区别左移和右移，算术移位以及逻辑移位的区别。
#### 描述与定义：
1. 输入端口:
   1. 32位输入 din
   2. 5位输入 shamt 表示需要移动的位数
   3. 1位输入 L/R 表示左移或右移
   4. 1位输入 A/L 表示算数移位或逻辑移位
2. 输出端口：
   1. 32位输出表示移位结果 dout

#### 实验原理图：
![](21.png)
#### 关键的设计语句/源代码
![](22.png)
#### 测试
仿真及开发板测试将在实验三一起给出
### 实验三：32位ALU
#### 整体方案设计：
ALU需要实现加法、移位、比较、减法、异或、或、与、取操作数B等操作。其中逻辑运算可以构建三十二位逻辑门阵列来实现，减法可以通过加法器实现、比较可以通过减法和标志位来实现。除此之外，还需要设计一个控制器模块，来对于不同的ALUctr来获得不同的标志信号，如SUBctr、SIGctr等等
#### 顶层模块设计：
1. 全加器模块
2. 32位桶形移位器
3. 控制器模块
#### 描述与定义：
1. ALU32
   1. 输入端口
      1. 32位输入dataa，datab分别为两个参与ALU运算的数据
      2. 4位aluctr为ALU操作控制信号
   2. 输出端口
      1. 32位输出 result 表示ALU运算的结果
      2. 1位输出 zero 表示结果是否为0
2. control_sign(信号控制器)
   1. 输入端口
      1. 四位输入 aluctr 表示ALU控制信号
   2. 输出端口
      1. 1位SUBctr 表示是否进行减法操作
      2. 1位SIGctr 表示比较是否带符号
      3. 1位ALctr 控制移位方式
      4. 1位SFTctr 控制移位方向
      5. 3位OPctr 选择加法器的输出
#### 实验原理图：
![](31.png)
#### 关键的设计语句/源代码
分别为控制器和ALU的关键代码
![](32.png)
![](33.png)
#### 实验数据仿真测试波形图
其中包含移位以及加法的仿真测试结果
![](313.png)
![](314.png)
#### 综合设计图
![](315.png)
#### 开发板验证
1、2图表示逻辑右移（将4右移14位）和加法的结果（4+1）
3、4图表示无符号小于比较(0100小于0110)以及异或操作（0110^0100）
5、6图表示逻辑左移（4左移六位）以及带符号小于比较（0100小于0110）
7、8图表示带符号数小于比较(0100大于1100)以及取操作数的结果
<div style="float:left;border:solid 1px 000;margin:2px;"><img src="34.png" width="330" height="300" ></div>
<div style="float:left;border:solid 1px 000;margin:2px;"><img src="35.png"  width="330" height="300" ></div>

<div style="float:left;border:solid 1px 000;margin:2px;"><img src="36.png" width="330" height="300" ></div>
<div style="float:left;border:solid 1px 000;margin:2px;"><img src="37.png"  width="330" height="300" ></div>

<div style="float:left;border:solid 1px 000;margin:2px;"><img src="38.png" width="330" height="300" ></div>
<div style="float:left;border:solid 1px 000;margin:2px;"><img src="39.png"  width="330" height="300" ></div>

<div style="float:left;border:solid 1px 000;margin:2px;"><img src="310.png" width="330" height="300" ></div>
<div style="float:left;border:solid 1px 000;margin:2px;"><img src="311.png"  width="330" height="300" ></div>
下图表示算术右移的结果(1100右移14位)

![](312.png)


### 思考题一：
![](316.png)
![](317.png)
如上图可以看到 LUT 部分在ALU中主要是控制器部分占比较高（可能是多路选择器较多）其次在总览中可以看到 IO 端口占比较高
### 思考题二：
由于组合逻辑中的比较器封装了无符号以及有符号比较的两种情况，并且拥有将结果扩展的功能，因此直接将两个操作数载入组合逻辑的比较器并且将结果载入到多路选择器中即可，并且将原来原理图中比较部分的电路删去。
### 思考题三：
要实现六十四位ALU，逻辑门阵列需要拓展到六十四位逻辑门，其次是加法器和桶形移位器，其中加法器可以通过两个32位CLA串行运算即可获得六十四位的加法器，而桶形移位器也应该进行拓展，但其原理是相同的。此外，还需要将零拓展和符号拓展改为六十四位，输入输出数据改为六十四位即可。
### 思考题四：
查阅得知Kogge-Stone加法器是一种基于二叉树结构的并行加法器，可以同时计算多个加法位。它的设计思想是利用并行计算的优势，减少加法器的延迟。
Kogge-Stone简要工作原理：
1. 将输入的两个n位操作数分别划分为n个单独的位组，每个位组包含两个输入位和一个输出位。
2. 第一层的位组中，每个位组的输出位等于其对应输入位的和。
3. 从第二层开始，每个位组的输出位等于其对应输入位和上一层中相邻位组的进位的和。
4. 最后一层的位组的输出位即为加法器的结果。



